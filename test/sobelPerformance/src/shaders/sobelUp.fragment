uniform sampler2D	texture;
uniform float		vOff;
uniform float		hOff;

varying vec2 vTexCoord;

const mat3 sobelH  = mat3(	1.0,2.0,1.0,
							0.0,0.0,0.0,
							-1.0,-2.0,-1.0);

const mat3 sobelV  = mat3(	-1.0,0.0,1.0,
							-2.0,0.0,2.0,
							-1.0,0.0,1.0);
vec2 offset[9] = vec2[](vec2(-hOff,-vOff),
						vec2(-hOff,0.0), 
						vec2(-vOff,vOff), 
						vec2(0.0,-vOff), 
						vec2(0.0,0.0), 
						vec2(0.0,vOff),
						vec2(vOff,-vOff), 
						vec2(vOff,0.0), 
						vec2(vOff,vOff) );

vec4 subMat[9];

void main (void)  
{  
	for(int i = 0; i < 9; i++){
		subMat[i] = texture2D(texture, vTexCoord + offset[i]); 
	}
	
	vec4 hEdge =	subMat[2] + (2.0*subMat[5]) + subMat[8] -
					(subMat[0] + (2.0*subMat[3]) + subMat[6]);

	vec4 vEdge =	subMat[0] + (2.0*subMat[1]) + subMat[2] -
					(subMat[6] + (2.0*subMat[7]) + subMat[8]);

	
	float rVal = sqrt(hEdge*hEdge+vEdge*vEdge);

	vec4 color = vec4(0.0,0.0,0.0,1.0);
	if(rVal > 0.3){
		color = vec4(1.0,1.0,1.0,1.0);	
	}
	

	gl_FragColor = color;
}    
